worker_processes  1;

events {
    worker_connections  1024;
}

http {
    include       mime.types;
    default_type  application/octet-stream;

    sendfile        off;
    #tcp_nopush     on;
    #keepalive_timeout  0;
    keepalive_timeout  65;
    gzip  on;

    server {
        listen       80;
        server_name localhost;
        charset utf-8;

        set $accessKey 2iS3_jb6UygGtw9AifhzYwGBQVRv6ULti-z1xevxScI;

        location /api/ {
            resolver 8.8.4.4 8.8.8.8 valid=300s;
            resolver_timeout 15s;
            proxy_set_header Host      api.unsplash.com;
            proxy_set_header Authorization "Client-ID $accessKey";
            proxy_set_header Accept-Version v1;
            proxy_ssl_server_name on;
            proxy_redirect off;
            proxy_pass https://api.unsplash.com/;
        }

        location = /oauth/token  {
            resolver 8.8.4.4 8.8.8.8 valid=300s;
            resolver_timeout 15s;
            proxy_set_header Host unsplash.com;
            proxy_ssl_server_name on;
            proxy_redirect off;
            proxy_pass https://unsplash.com/oauth/token?client_id=$accessKey;
        }

        location = /oauth/authorize  {
            resolver 8.8.4.4 8.8.8.8 valid=300s;
            resolver_timeout 15s;
            proxy_set_header Host      unsplash.com;
            proxy_ssl_server_name on;
            proxy_redirect off;
            proxy_pass https://unsplash.com/oauth/authorize?client_id=$accessKey;
        }

        location = / {
            root   html;
        }

        error_page   500 502 503 504  /50x.json;
        location = /50x.json {
            root   html;
        }
    }

}
